"use strict";(()=>{var t={};t.id=189,t.ids=[189],t.modules={145:t=>{t.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},5613:t=>{t.exports=import("@google/genai")},6249:(t,e)=>{Object.defineProperty(e,"l",{enumerable:!0,get:function(){return function t(e,n){return n in e?e[n]:"then"in e&&"function"==typeof e.then?e.then(e=>t(e,n)):"function"==typeof e&&"default"===n?e:void 0}}})},7858:(t,e,n)=>{n.a(t,async(t,r)=>{try{n.r(e),n.d(e,{config:()=>u,default:()=>l,routeModule:()=>d});var i=n(1802),o=n(7153),s=n(6249),a=n(6732),c=t([a]);a=(c.then?(await c)():c)[0];let l=(0,s.l)(a,"default"),u=(0,s.l)(a,"config"),d=new i.PagesAPIRouteModule({definition:{kind:o.x.PAGES_API,page:"/api/cases",pathname:"/api/cases",bundlePath:"",filename:""},userland:a});r()}catch(t){r(t)}})},6732:(t,e,n)=>{n.a(t,async(t,r)=>{try{n.r(e),n.d(e,{default:()=>a});var i=n(5613),o=t([i]);i=(o.then?(await o)():o)[0];let c=process.env.GEMINI_API_KEY,l=c?new i.GoogleGenAI({apiKey:c}):null,u=[{caseId:"case_001",title:"緊急入院：急性心筋梗塞疑い",targetSkill:"正確性",coreInstruction:"70代男性の急性心筋梗塞疑いに関するカルテを作成します。時間軸、具体的な処置、医療用語の適切性に着目してください。",hintInstruction:"時間軸、処置の具体性、病棟へ「上げた」という表現の適切性を見直しましょう。"},{caseId:"case_002",title:"経過観察：慢性腎不全",targetSkill:"臨床的配慮度",coreInstruction:"慢性腎不全患者の経過観察記録です。検査結果の推移と、それに対する主治医との連携内容の記録に着目してください。",hintInstruction:"報告の具体的な時間と、主治医からの指示内容を記録に追加しましょう。"},{caseId:"case_003",title:"術後管理：腹腔鏡下胆嚢摘出術",targetSkill:"簡潔性",coreInstruction:"腹腔鏡下胆嚢摘出術後の患者管理記録です。主観的な表現を避け、客観的な情報と指示内容で簡潔に記述する能力が問われます。",hintInstruction:"「少し気分が悪そう」といった主観的な表現は避け、具体的な症状とそれに対する指示を明確に記述しましょう。"}];async function s(t){if(!l)return console.warn("API Key missing (GEMINI_API_KEY). Returning fallback data for case variation."),{...t,originalText:`【S】${t.coreInstruction.split("。")[0]}。${t.targetSkill}に問題があります。
【O】バイタル、フィジカルは記載なし。
【A】元の文章に不備が多い。
【P】修正が必要。`,hintInstruction:t.hintInstruction};let e=`あなたは経験豊富な医療シナリオジェネレーターです。研修医が書いたばかりのSOAP形式のカルテ文章を生成してください。
    
    生成するカルテは、以下の要素を**意図的に不十分または不適切**に含める必要があります。
    1. **SOAP形式 (Subjective, Objective, Assessment, Plan)** を意識しているが、各セクションの内容が**不足している、または混在している**。
    2. 主観的な表現や、曖昧で客観的ではない表現が含まれている。
    3. 時系列や具体的な処置内容が欠けている、または不正確である。
    4. 臨床的配慮に欠ける（例：「うるさい患者」など）表現が紛れ込んでいる。

    与えられた課題のコアメッセージを保持しつつ、患者の情報（年齢、時間など）はランダムに少しだけ変更し、元のシナリオに多様なバリエーションを加えた新しい問題文を生成してください。

以下の形式でJSONオブジェクトを返してください。
1. originalText: 修正が必要な、新しいバリエーションのSOAP形式カルテ文章
2. hintInstruction: 新しいoriginalTextの内容に合わせて微調整された具体的なヒント`,n=`以下の課題テンプレートに基づいて、**SOAP形式で記載され、かつ不備が多い**異なるバリエーションのオリジナルテキスト（originalText）と、それに合わせたヒント（hintInstruction）を生成してください。

課題タイトル: ${t.title}
ターゲットスキル: ${t.targetSkill}
コアメッセージ: ${t.coreInstruction}`;try{let r=await l.models.generateContent({model:"gemini-2.5-flash",contents:[{role:"user",parts:[{text:n}]}],config:{systemInstruction:{parts:[{text:e}]},responseMimeType:"application/json",responseSchema:{type:"OBJECT",properties:{originalText:{type:"STRING",description:"SOAP形式で記載された、不備が多いバリエーションカルテ文章"},hintInstruction:{type:"STRING",description:"新しいオリジナルテキストに合わせた具体的なヒント"}},propertyOrdering:["originalText","hintInstruction"]}}}),i=JSON.parse(r.candidates[0].content.parts[0].text);return{...t,originalText:i.originalText,hintInstruction:i.hintInstruction}}catch(e){return console.error(`Error generating case variation for ${t.caseId}:`,e),{...t,originalText:t.coreInstruction,hintInstruction:t.hintInstruction}}}async function a(t,e){if(e.setHeader("Access-Control-Allow-Origin","*"),e.setHeader("Access-Control-Allow-Methods","GET, OPTIONS"),e.setHeader("Access-Control-Allow-Headers","Content-Type"),"OPTIONS"===t.method)return e.status(200).end();if("GET"!==t.method)return e.status(405).json({message:"Method Not Allowed"});try{let t=u.map(s),n=await Promise.all(t);e.status(200).json(n)}catch(t){console.error("Failed to process case list:",t),e.status(500).json({message:"課題リストの生成中にサーバーエラーが発生しました。"})}}r()}catch(t){r(t)}})},7153:(t,e)=>{var n;Object.defineProperty(e,"x",{enumerable:!0,get:function(){return n}}),function(t){t.PAGES="PAGES",t.PAGES_API="PAGES_API",t.APP_PAGE="APP_PAGE",t.APP_ROUTE="APP_ROUTE"}(n||(n={}))},1802:(t,e,n)=>{t.exports=n(145)}};var e=require("../../webpack-api-runtime.js");e.C(t);var n=e(e.s=7858);module.exports=n})();